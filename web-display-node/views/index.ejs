<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Sistem Surat Desa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: {
                            400: '#e6b800',
                            500: '#d4a900',
                            600: '#c29a00',
                            700: '#b08b00',
                        },
                        golden: {
                            50: '#fff9e6',
                            100: '#fff2cc',
                            200: '#ffe699',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-slow': 'pulse 3s infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .sidebar-link {
            transition: all 0.2s ease;
        }
        .sidebar-link:hover {
            transform: translateX(4px);
            box-shadow: 2px 0 0 0 #d4a900 inset;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .footer-link {
            transition: all 0.2s ease;
        }
        .footer-link:hover {
            color: #d4a900;
            transform: translateY(-2px);
        }
        .active-menu {
            background-color: #fff2cc;
            color: #b08b00;
            font-weight: 600;
            border-left: 4px solid #d4a900;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            min-width: 280px;
            z-index: 50;
        }
        .show-dropdown {
            display: block;
            animation: fadeIn 0.3s;
        }
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
        }
        .mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        .mobile-menu.open {
            transform: translateX(0);
        }
        @media (min-width: 768px) {
            .mobile-menu {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen font-sans">
    <!-- Navbar -->
    <nav class="bg-gradient-to-r from-gold-600 to-gold-500 p-4 text-white shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <button id="mobileMenuButton" class="md:hidden mr-2 text-white focus:outline-none">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="bg-white p-2 rounded-lg shadow-md">
                    <i class="fas fa-envelope-open-text text-gold-600 text-xl"></i>
                </div>
                <span class="text-xl font-bold tracking-wide">Sistem Surat Desa</span>
            </div>
            <div class="flex items-center space-x-4">
                <div class="hidden md:block bg-gold-700 px-3 py-1 rounded-full text-sm font-medium animate-pulse-slow">
                    <i class="fas fa-circle text-xs mr-1"></i> Online
                </div>
    
                <div class="relative">
                    <button id="notificationBtn" class="p-2 rounded-full hover:bg-gold-700 relative">
                        <i class="fas fa-bell text-xl"></i>
                        <% if (notifications.filter(n => !n.is_read).length > 0) { %>
                            <span class="notification-badge bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
                                <%= notifications.filter(n => !n.is_read).length %>
                            </span>
                        <% } %>
                    </button>
                
                    <div id="notificationDropdown" class="hidden absolute right-0 mt-2 bg-white rounded-md shadow-lg py-2 w-80 z-50">
                        <div class="px-4 py-2 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="font-semibold text-gray-800">Notifikasi</h3>
                            <span class="text-xs text-gold-600">
                                <%= notifications.filter(n => !n.is_read).length %> baru
                            </span>
                        </div>
                        <div class="max-h-60 overflow-y-auto" id="notificationsContainer">
                            <% notifications.forEach(n => { %>
                                <div class="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 notification-item"
                                     data-type="<%= n.related_type %>" 
                                     data-id="<%= n.related_id %>">
                                    <p class="text-sm <%= n.is_read ? 'text-gray-500' : 'text-gray-700 font-semibold' %>">
                                        <%= n.title %><br>
                                        <strong>No. Surat:</strong> <%= n.nomor_surat %><br>
                                        <strong>Nama:</strong> <%= n.nama %>
                                    </p>
                                    <p class="text-xs text-gray-400 mt-1">
                                        <%= new Date(n.created_at).toLocaleString('id-ID') %>
                                    </p>
                                </div>
                            <% }); %>
                        </div>
                        <div class="px-4 py-2 border-t border-gray-200 text-center">
                            <a href="/notifications" class="text-sm text-gold-600 hover:underline">Lihat semua notifikasi</a>
                        </div>
                    </div>
                </div>
                
    
                <div class="relative">
    <button id="historyBtn" class="p-2 rounded-full hover:bg-gold-700">
        <i class="fas fa-history text-xl"></i>
    </button>
    <div id="historyDropdown" class="dropdown-content mt-2 bg-white rounded-md shadow-lg py-2 w-72 hidden">
        <div class="px-4 py-2 border-b border-gray-200">
            <h3 class="font-semibold text-gray-800">Riwayat Aktivitas Terakhir</h3>
        </div>
        <div id="activityList" class="max-h-60 overflow-y-auto">
            <div class="px-4 py-3 text-center text-gray-500">
                Klik untuk memuat riwayat
            </div>
        </div>
        <div class="px-4 py-2 border-t border-gray-200 text-center">
            <a href="/riwayat-lengkap" class="text-sm text-gold-600 hover:underline">Lihat riwayat lengkap</a>
        </div>
    </div>
</div>
    
                <div class="relative">
                    <div class="flex items-center space-x-2 cursor-pointer p-2" onclick="toggleProfileDropdown()">
                        <span class="text-sm font-medium hidden md:block"><%= userName %></span>
                        <div class="h-10 w-10 rounded-full bg-white flex items-center justify-center shadow-inner border-2 border-gold-300">
                            <i class="fas fa-user text-gold-600"></i>
                        </div>
                    </div>
        
                    <div id="profileDropdown" class="absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg hidden z-10">
                        <div class="py-2">
                            <a href="/profil" class="block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                <i class="fas fa-user mr-2"></i> Profil
                            </a>
                            <a href="/logout" class="block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                <i class="fas fa-sign-out-alt mr-2"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
        
    
            </div>
        </div>
    </nav>
    
    

    <!-- Main Content -->
    <div class="flex flex-1 relative">
        <!-- Mobile Sidebar Overlay -->
        <div id="mobileOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden hidden"></div>
        
        <!-- Sidebar -->
        <aside id="sidebar" class="mobile-menu fixed md:static inset-y-0 left-0 w-64 bg-white shadow-md p-4 border-r border-gray-200 z-50 md:block md:sticky md:top-0 md:h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6 p-2 border-b border-gold-100 md:hidden">
                <h3 class="text-lg font-semibold">Menu Navigasi</h3>
                <button id="closeSidebar" class="text-gray-500 hover:text-gold-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="mb-6 p-2 border-b border-gold-100">
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center">
                    <i class="fas fa-list-ul mr-2 text-gold-500"></i> Menu Surat
                </h3>
            </div>
            <ul class="space-y-2">
                <li>
                    <a href="/" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in active-menu">
                        <i class="fas fa-home mr-3 text-gold-600 w-5 text-center"></i>
                        Beranda
                        <span class="ml-auto bg-gold-100 text-gold-700 text-xs px-2 py-1 rounded-full">Home</span>
                    </a>
                </li>
                <li>
                    <a href="/surat-sktm" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-hand-holding-usd mr-3 text-gold-600 w-5 text-center"></i>
                        Surat Keterangan Tidak Mampu
                    </a>
                </li>
                <li>
                    <a href="/surat-ku" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-briefcase mr-3 text-gold-600 w-5 text-center"></i>
                        Surat Keterangan Usaha
                    </a>
                </li>
                <li>
                    <a href="/surat-kbi" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-id-card mr-3 text-gold-600 w-5 text-center"></i>
                        Surat Beda Identitas
                    </a>
                </li>
                <li>
                    <a href="/surat-pengantar" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-envelope mr-3 text-gold-600 w-5 text-center"></i>
                        Surat Pengantar
                        <span class="ml-auto bg-gold-100 text-gold-700 text-xs px-2 py-1 rounded-full">New</span>
                    </a>
                </li>
            </ul>
        
            <div class="mt-8 mb-6 p-2 border-b border-gold-100">
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center">
                    <i class="fas fa-cog mr-2 text-gold-500"></i> Administrasi
                </h3>
            </div>
            <ul class="space-y-2">
                <li>
                    <a href="/statistik" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-chart-pie mr-3 text-gold-600 w-5 text-center"></i>
                        Statistik
                    </a>
                </li>
                <li>
                    <a href="/pengaturan" class="sidebar-link flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-golden-100 rounded-md transition-all animate-fade-in">
                        <i class="fas fa-cogs mr-3 text-gold-600 w-5 text-center"></i>
                        Pengaturan
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Content Area -->
        <main class="flex-1 p-4 md:p-6 animate-slide-up overflow-x-hidden">
            <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 border border-gold-100">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <div>
                        <h1 class="text-xl md:text-2xl lg:text-3xl font-bold text-gray-800 mb-1">Selamat Datang, Admin Desa</h1>
                        <p class="text-sm md:text-base text-gray-600">Kelola berbagai jenis surat keterangan dengan mudah</p>
                    </div>
                    <!-- <div class="mt-4 md:mt-0 w-full md:w-auto">
                        <button class="w-full md:w-auto bg-gold-600 hover:bg-gold-700 text-white px-4 py-2 rounded-lg shadow-md transition-all duration-200 flex items-center justify-center">
                            <i class="fas fa-plus mr-2"></i> Buat Surat Baru
                        </button>
                    </div> -->
                </div>
                
                <!-- Quick Stats -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                    <div class="bg-gradient-to-br from-gold-50 to-gold-100 border border-gold-200 rounded-xl p-4 md:p-5 shadow-sm card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs md:text-sm text-gray-600">Total Surat</p>
                                <p class="text-xl md:text-2xl font-bold text-gray-800 mt-1"><%= totalSurat %></p>
                            </div>
                            <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full">
                                <i class="fas fa-envelope text-lg md:text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-2 md:mt-3 text-xs text-gold-700 flex items-center">
                            <i class="fas fa-arrow-up mr-1"></i> 12% dari bulan lalu
                        </div>
                    </div>
                
                    <div class="bg-gradient-to-br from-gold-50 to-gold-100 border border-gold-200 rounded-xl p-4 md:p-5 shadow-sm card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs md:text-sm text-gray-600">Surat Diproses</p>
                                <p class="text-xl md:text-2xl font-bold text-gray-800 mt-1"><%= diproses %></p>
                            </div>
                            <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full">
                                <i class="fas fa-clock text-lg md:text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-2 md:mt-3 text-xs text-gold-700 flex items-center">
                            <i class="fas fa-arrow-down mr-1"></i> 3 dari kemarin
                        </div>
                    </div>
                
                    <div class="bg-gradient-to-br from-gold-50 to-gold-100 border border-gold-200 rounded-xl p-4 md:p-5 shadow-sm card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs md:text-sm text-gray-600">Surat Selesai</p>
                                <p class="text-xl md:text-2xl font-bold text-gray-800 mt-1"><%= selesai %></p>
                            </div>
                            <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full">
                                <i class="fas fa-check-circle text-lg md:text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-2 md:mt-3 text-xs text-gold-700 flex items-center">
                            <i class="fas fa-arrow-up mr-1"></i> 8 dari kemarin
                        </div>
                    </div>
                
                    <div class="bg-gradient-to-br from-gold-50 to-gold-100 border border-gold-200 rounded-xl p-4 md:p-5 shadow-sm card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs md:text-sm text-gray-600">Surat Ditolak</p>
                                <p class="text-xl md:text-2xl font-bold text-gray-800 mt-1"><%= ditolak %></p>
                            </div>
                            <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full">
                                <i class="fas fa-times-circle text-lg md:text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-2 md:mt-3 text-xs text-gold-700 flex items-center">
                            <i class="fas fa-equals mr-1"></i> Tidak berubah
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                            <div class="mb-8">
                <h2 class="text-lg md:text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-bolt text-gold-500 mr-2"></i> Akses Cepat
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                    <a href="#" id="buatSuratBtn" class="bg-white border border-gold-200 rounded-lg p-3 md:p-4 shadow-sm card-hover text-center">
                        <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full inline-block">
                            <i class="fas fa-envelope text-lg md:text-xl"></i>
                        </div>
                        <h3 class="text-sm md:text-base font-medium mt-2">Buat Surat</h3>
                        <p class="text-xs text-gray-500 mt-1">Surat pengantar baru</p>
                    </a>
                
                    <div id="suratModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
                        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                            <div class="mt-3 text-center">
                                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Pilih Jenis Surat</h3>
                                <div class="space-y-2">
                                    <a href="/surat-sktm" class="flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-gold-100 rounded-md transition-all">
                                        <i class="fas fa-hand-holding-usd mr-3 text-gold-600 w-5 text-center"></i>
                                        Surat Keterangan Tidak Mampu
                                    </a>
                                    <a href="/surat-ku" class="flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-gold-100 rounded-md transition-all">
                                        <i class="fas fa-briefcase mr-3 text-gold-600 w-5 text-center"></i>
                                        Surat Keterangan Usaha
                                    </a>
                                    <a href="/surat-kbi" class="flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-gold-100 rounded-md transition-all">
                                        <i class="fas fa-id-card mr-3 text-gold-600 w-5 text-center"></i>
                                        Surat Beda Identitas
                                    </a>
                                    <a href="/surat-pengantar" class="flex items-center p-3 text-gray-700 hover:text-gold-700 hover:bg-gold-100 rounded-md transition-all">
                                        <i class="fas fa-envelope mr-3 text-gold-600 w-5 text-center"></i>
                                        Surat Pengantar
                                        <span class="ml-auto bg-gold-100 text-gold-700 text-xs px-2 py-1 rounded-full">New</span>
                                    </a>
                                </div>
                                <div class="items-center px-4 py-3 mt-4">
                                    <button id="tutupModalBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">Tutup</button>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="mb-8 h-full">
                        <a href="#" id="cariSuratBtn" class="bg-white border border-gold-200 rounded-lg p-3 md:p-4 shadow-sm card-hover flex flex-col items-center justify-center h-full">
                            <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full inline-block">
                                <i class="fas fa-search text-lg md:text-xl" style="transform: translateY(-15px);"></i>
                            </div>
                            <h3 class="text-sm md:text-base font-medium mt-0" style="margin-top: -5px;">Cari Surat</h3>
                            <span class="text-xs text-gray-500 mt-1" style="margin-top: 3px;">Temukan surat tertentu</span>
                        </a>
                    </div>
                
                    <div id="cariSuratModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden animate-fade-in">
                        <div class="relative top-20 mx-auto p-6 border w-96 shadow-lg rounded-md bg-white">
                            <div class="mt-3 text-center">
                                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Cari Surat</h3>
                                <div class="flex items-center mb-4">
                                    <input type="text" id="nomorSurat" placeholder="Masukkan Nomor Surat" class="border rounded-md p-3 w-full focus:outline-none focus:ring-2 focus:ring-gold-500">
                                    <button id="cariSuratSubmitBtn" class="bg-gold-500 hover:bg-gold-700 text-white font-bold py-3 px-4 rounded ml-2">Cari</button>
                                </div>
                                <div id="hasilPencarian" class="mt-4 p-4">
                                    </div>
                                <div class="items-center px-4 py-3 mt-4">
                                    <button id="tutupCariModalBtn" class="px-4 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">Tutup</button>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <a href="/statistik" class="bg-white border border-gold-200 rounded-lg p-3 md:p-4 shadow-sm card-hover text-center h-full">
                        <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full inline-block">
                            <i class="fas fa-chart-bar text-lg md:text-xl"></i>
                        </div>
                        <h3 class="text-sm md:text-base font-medium mt-2">Lihat Statistik</h3>
                        <p class="text-xs text-gray-500 mt-1">Analisis data surat</p>
                    </a>
                
                    <a href="#" id="kirimKonfirmasiWA" class="bg-white border border-gold-200 rounded-lg p-3 md:p-4 shadow-sm card-hover text-center h-full">
                         <div class="bg-gold-100 text-gold-600 p-2 md:p-3 rounded-full inline-block">
                        <i class="fab fa-whatsapp text-lg md:text-xl"></i>
                        </div>
                       <h3 class="text-sm md:text-base font-medium mt-2">Kirim Konfirmasi WA</h3>
                         <p class="text-xs text-gray-500 mt-1">Notifikasi surat selesai</p>
                         </a>
                </div>
                
                <style>
                    #cariSuratBtn {
                        align-items: center;
                        margin-top: -1px;
                    }
                </style>
                            <!-- Recent Activity -->
                <div>
                    <h2 class="text-lg md:text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-history text-gold-500 mr-2"></i> Aktivitas Terkini
                    </h2>
                    <div class="bg-golden-50 rounded-lg border border-gold-100 overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gold-100">
                                    <tr>
                                        <th class="px-3 py-2 md:px-4 md:py-3 text-left text-xs font-medium text-gold-800 uppercase tracking-wider">No. Surat</th>
                                        <th class="px-3 py-2 md:px-4 md:py-3 text-left text-xs font-medium text-gold-800 uppercase tracking-wider">Jenis</th>
                                        <th class="px-3 py-2 md:px-4 md:py-3 text-left text-xs font-medium text-gold-800 uppercase tracking-wider">Nama</th>
                                        <th class="px-3 py-2 md:px-4 md:py-3 text-left text-xs font-medium text-gold-800 uppercase tracking-wider">Status</th>
                                        <th class="px-3 py-2 md:px-4 md:py-3 text-left text-xs font-medium text-gold-800 uppercase tracking-wider">Tanggal</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gold-100">
                                    <tr class="hover:bg-golden-100">
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm font-medium text-gray-900">SP/0128/2023</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Pengantar</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Budi Santoso</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap">
                                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                Selesai
                                            </span>
                                        </td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">12 Jan 2023</td>
                                    </tr>
                                    <tr class="hover:bg-golden-100">
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm font-medium text-gray-900">SKU/0042/2023</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Keterangan Usaha</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Siti Aminah</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap">
                                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                Diproses
                                            </span>
                                        </td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">11 Jan 2023</td>
                                    </tr>
                                    <tr class="hover:bg-golden-100">
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm font-medium text-gray-900">SP/0127/2023</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Pengantar</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">Ahmad Fauzi</td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap">
                                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">
                                                Ditolak
                                            </span>
                                        </td>
                                        <td class="px-3 py-2 md:px-4 md:py-3 whitespace-nowrap text-xs md:text-sm text-gray-500">10 Jan 2023</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white">
        <div class="container mx-auto px-4 md:px-6 py-6 md:py-8">
            <div class="flex flex-col md:flex-row justify-between">
                <div class="mb-8 md:mb-0">
                    <div class="flex items-center mb-4">
                        <div class="bg-gold-500 p-2 rounded-lg mr-3">
                            <i class="fas fa-envelope-open-text text-white"></i>
                        </div>
                        <span class="text-lg md:text-xl font-bold">Sistem Surat Desa</span>
                    </div>
                    <p class="text-gray-400 text-xs md:text-sm max-w-xs">
                        Sistem pelayanan surat menyurat digital untuk mempermudah administrasi warga Desa Sojiwan.
                    </p>
                    <p class="text-gold-400 font-semibold mt-3 md:mt-4 text-sm md:text-base">Â© 2025 Tim KKN Sowan Sojiwan</p>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-6 md:gap-8">
                    <div>
                        <h3 class="text-gold-400 font-semibold mb-3 md:mb-4 text-base md:text-lg">Navigasi</h3>
                        <ul class="space-y-1 md:space-y-2">
                            <li><a href="/" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Beranda</a></li>
                            <li><a href="/surat-pengantar" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Surat Pengantar</a></li>
                            <li><a href="/page_statistik" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Statistik</a></li>
                            <li><a href="/pengaturan" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Pengaturan</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-gold-400 font-semibold mb-3 md:mb-4 text-base md:text-lg">Bantuan</h3>
                        <ul class="space-y-1 md:space-y-2">
                            <li><a href="/tutorial-penggunaan" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Tutorial Penggunaan</a></li>
                            <li><a href="/faq" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">FAQ</a></li>
                            <li><a href="/kebijakan-privasi" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Kebijakan Privasi</a></li>
                            <li><a href="/syarat-ketentuan" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">Syarat & Ketentuan</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-gold-400 font-semibold mb-3 md:mb-4 text-base md:text-lg">Kontak</h3>
                        <ul class="space-y-1 md:space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-map-marker-alt text-gold-400 mr-2 mt-1 text-xs md:text-sm"></i>
                                <span class="text-xs md:text-sm text-gray-300">Desa Kebondalem Kidul, Jawa Tengah</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-envelope text-gold-400 mr-2 mt-1 text-xs md:text-sm"></i>
                                <a href="mailto:kkn.sojiwan2025@example.com" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">kkn.sojiwan2025@example.com</a>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-phone-alt text-gold-400 mr-2 mt-1 text-xs md:text-sm"></i>
                                <a href="tel:+6281234567890" class="footer-link text-xs md:text-sm text-gray-300 hover:text-gold-400">+62 812-3456-7890</a>
                            </li>
                        </ul>
                        <div class="mt-3 md:mt-4 flex space-x-3 md:space-x-4">
                            <a href="#" class="footer-link text-gray-300 hover:text-gold-400 text-base md:text-xl">
                                <i class="fab fa-facebook"></i>
                            </a>
                            <a href="#" class="footer-link text-gray-300 hover:text-gold-400 text-base md:text-xl">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="footer-link text-gray-300 hover:text-gold-400 text-base md:text-xl">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-6 md:mt-8 pt-4 md:pt-6 text-center">
                <p class="text-gray-400 text-xs md:text-sm">
                    Sistem ini dikembangkan oleh Tim KKN UPN "VETERAN" YOGYAKARTA 2025 untuk Desa Kebondalem Kidul
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile sidebar toggle
        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const closeSidebar = document.getElementById('closeSidebar');
        const sidebar = document.getElementById('sidebar');
        const mobileOverlay = document.getElementById('mobileOverlay');
        
        mobileMenuButton.addEventListener('click', function() {
            sidebar.classList.add('open');
            mobileOverlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        });
        
        closeSidebar.addEventListener('click', function() {
            sidebar.classList.remove('open');
            mobileOverlay.classList.add('hidden');
            document.body.style.overflow = '';
        });
        
        mobileOverlay.addEventListener('click', function() {
            sidebar.classList.remove('open');
            mobileOverlay.classList.add('hidden');
            document.body.style.overflow = '';
        });
        
        // Close sidebar when clicking a link (for mobile)
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        sidebarLinks.forEach(link => {
            link.addEventListener('click', function() {
                if (window.innerWidth < 768) {
                    sidebar.classList.remove('open');
                    mobileOverlay.classList.add('hidden');
                    document.body.style.overflow = '';
                }
            });
        });
        
        // Toggle notification dropdown
        document.getElementById('notificationBtn').addEventListener('click', function() {
            document.getElementById('notificationDropdown').classList.toggle('show-dropdown');
            document.getElementById('historyDropdown').classList.remove('show-dropdown');
        });
        
        // Toggle history dropdown
        document.getElementById('historyBtn').addEventListener('click', function() {
            document.getElementById('historyDropdown').classList.toggle('show-dropdown');
            document.getElementById('notificationDropdown').classList.remove('show-dropdown');
        });
        
        // Close dropdowns when clicking outside
        window.addEventListener('click', function(event) {
            if (!event.target.matches('#notificationBtn') && !event.target.closest('#notificationDropdown')) {
                document.getElementById('notificationDropdown').classList.remove('show-dropdown');
            }
            if (!event.target.matches('#historyBtn') && !event.target.closest('#historyDropdown')) {
                document.getElementById('historyDropdown').classList.remove('show-dropdown');
            }
        });
        
        // Adjust main content margin when sidebar is toggled
        function adjustContentMargin() {
            const sidebarWidth = document.querySelector('aside').offsetWidth;
            if (window.innerWidth >= 768) {
                document.querySelector('main').style.marginLeft = `${sidebarWidth}px`;
            } else {
                document.querySelector('main').style.marginLeft = '0';
            }
        }
        
        </script>
         <script>
            function toggleProfileDropdown() {
                const dropdown = document.getElementById('profileDropdown');
                dropdown.classList.toggle('hidden');
            }
        </script>
     <script>
        const buatSuratBtn = document.getElementById('buatSuratBtn');
        const suratModal = document.getElementById('suratModal');
        const tutupModalBtn = document.getElementById('tutupModalBtn');
    
        buatSuratBtn.addEventListener('click', () => {
            suratModal.classList.remove('hidden');
        });
    
        tutupModalBtn.addEventListener('click', () => {
            suratModal.classList.add('hidden');
        });
    </script>
  <script>
    const cariSuratBtn = document.getElementById('cariSuratBtn');
    const cariSuratModal = document.getElementById('cariSuratModal');
    const tutupCariModalBtn = document.getElementById('tutupCariModalBtn');
    const cariSuratSubmitBtn = document.getElementById('cariSuratSubmitBtn');
    const hasilPencarianDiv = document.getElementById('hasilPencarian');
    const nomorSuratInput = document.getElementById('nomorSurat');

    cariSuratBtn.addEventListener('click', () => {
        cariSuratModal.classList.remove('hidden');
    });

    tutupCariModalBtn.addEventListener('click', () => {
        cariSuratModal.classList.add('hidden');
    });

    cariSuratSubmitBtn.addEventListener('click', function() {
    const nomorSurat = nomorSuratInput.value.trim(); // Menghilangkan spasi

    hasilPencarianDiv.innerHTML = '<p class="text-gray-600">Mencari...</p>'; // Menampilkan pesan loading

    fetch(`/cari-surat?nomor=${nomorSurat}`)
        .then(response => response.json())
        .then(data => {
            hasilPencarianDiv.innerHTML = ''; // Bersihkan hasil sebelumnya

            if (data.success) {
                if (data.result) {
                    const surat = data.result;
                    hasilPencarianDiv.innerHTML = `
                        <p class="text-green-600 font-semibold mb-2">Surat ditemukan!</p>
                        <div class="flex justify-content: space-between mb-2">
                            <span class="font-medium" style="width: 150px;">Nomor Surat:</span>
                            <span class="font-medium">${surat.nomor_surat}</span>
                        </div>
                        <div class="flex justify-content: space-between mb-2">
                            <span class="font-medium" style="width: 150px;">Nama:</span>
                            <span class="font-medium">${surat.nama}</span>
                        </div>
                        <div class="flex justify-content: space-between mb-2">
                            <span class="font-medium" style="width: 150px;">Status:</span>
                            <span class="font-medium">${surat.status}</span>
                        </div>
                        <a href="${surat.link}" class="text-gold-600 hover:underline mt-2 block">Lihat Selengkapnya</a>
                    `;
                } else {
                    hasilPencarianDiv.innerHTML = '<p class="text-red-600 font-semibold">Surat tidak ditemukan.</p>';
                }
            } else {
                hasilPencarianDiv.innerHTML = '<p class="text-red-600 font-semibold">Terjadi kesalahan.</p>';
            }
        });
});
</script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Notification dropdown toggle
        const notificationBtn = document.getElementById('notificationBtn');
        const notificationDropdown = document.getElementById('notificationDropdown');
        
        if (notificationBtn && notificationDropdown) {
            notificationBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                notificationDropdown.classList.toggle('hidden');
                
                // Mark as read when opened
                if (!notificationDropdown.classList.contains('hidden')) {
                    markNotificationsAsRead();
                }
            });
        }

        // Handle notification item clicks
        document.querySelectorAll('.notification-item').forEach(item => {
            item.addEventListener('click', function() {
                const type = this.dataset.type;
                const id = this.dataset.id;
                window.location.href = `/${type}/${id}`;
            });
        });

        // SSE for real-time notifications
        if (typeof(EventSource) !== "undefined") {
            const eventSource = new EventSource('/notifications-stream');
            
            eventSource.addEventListener('new-notification', (e) => {
                const notification = JSON.parse(e.data);
                addNewNotification(notification);
                updateBadgeCount(1);
            });

            eventSource.onerror = () => {
                console.log('SSE connection error');
                eventSource.close();
            };
        }

        // Helper functions
        function markNotificationsAsRead() {
            fetch('/mark-notifications-read', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            }).then(() => {
                document.querySelectorAll('.notification-badge').forEach(badge => {
                    badge.textContent = '0';
                });
            });
        }

        function addNewNotification(notification) {
            const container = document.getElementById('notificationsContainer');
            if (!container) return;

            const notificationElement = document.createElement('div');
            notificationElement.className = 'px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 notification-item';
            notificationElement.dataset.type = notification.type;
            notificationElement.dataset.id = notification.related_id;
            notificationElement.innerHTML = `
                <p class="text-sm text-gray-700 font-semibold">
                    ${notification.title}<br>
                    <strong>No. Surat:</strong> ${notification.nomor_surat}<br>
                    <strong>Nama:</strong> ${notification.nama}
                </p>
                <p class="text-xs text-gray-400 mt-1">
                    ${new Date(notification.created_at).toLocaleString('id-ID')}
                </p>
            `;

            notificationElement.addEventListener('click', () => {
                window.location.href = `/${notification.type}/${notification.related_id}`;
            });

            container.insertBefore(notificationElement, container.firstChild);
        }

        function updateBadgeCount(increment = 1) {
            const badge = document.querySelector('.notification-badge');
            if (badge) {
                const currentCount = parseInt(badge.textContent) || 0;
                badge.textContent = currentCount + increment;
            } else {
                const newBadge = document.createElement('span');
                newBadge.className = 'notification-badge bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center';
                newBadge.textContent = increment;
                notificationBtn.appendChild(newBadge);
            }
        }
    });
</script>
